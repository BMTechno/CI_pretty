! function(e, t, a, n) {
    function o(t, a) {
        this.element = t, this.settings = e.extend({}, s, a), this._defaults = s, this._name = i, this.init()
    }

    function l(e) {
        return (e.filename ? e.filename : "table2excel") + ".xls"
    }
    var i = "table2excel",
        s = {
            exclude: ".noExl",
            name: "Table2Excel"
        };
    o.prototype = {
        init: function() {
            var t = this;
            t.template = {
                head: '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><!--[if gte mso 9]><head><xml><x:ExcelWorkbook><x:ExcelWorksheets>',
                sheet: {
                    head: "<x:ExcelWorksheet><x:Name>",
                    tail: "</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"
                },
                mid: "</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><![endif]--><body>",
                table: {
                    head: "<table>",
                    tail: "</table>"
                },
                foot: "</body></html>"
            }, t.tableRows = [], e(t.element).each(function(a, n) {
                var o = "";
                e(n).find("tr").not(t.settings.exclude).each(function(t, a) {
                    o += "<tr>" + e(a).html() + "</tr>"
                }), t.tableRows.push(o)
            }), t.tableToExcel(t.tableRows, t.settings.name)
        },
        tableToExcel: function(n, o) {
            var i, s, r, c = this,
                m = "";
            if (c.uri = "data:application/vnd.ms-excel;base64,", c.base64 = function(e) {
                    return t.btoa(unescape(encodeURIComponent(e)))
                }, c.format = function(e, t) {
                    return e.replace(/{(\w+)}/g, function(e, a) {
                        return t[a]
                    })
                }, c.ctx = {
                    worksheet: o || "Worksheet",
                    table: n
                }, m = c.template.head, e.isArray(n))
                for (i in n) m += c.template.sheet.head + "Table" + i + c.template.sheet.tail;
            if (m += c.template.mid, e.isArray(n))
                for (i in n) m += c.template.table.head + "{table" + i + "}" + c.template.table.tail;
            m += c.template.foot;
            for (i in n) c.ctx["table" + i] = n[i];
            if (delete c.ctx.table, "undefined" != typeof msie && msie > 0 || navigator.userAgent.match(/Trident.*rv\:11\./))
                if ("undefined" != typeof Blob) {
                    m = [m];
                    var x = new Blob(m, {
                        type: "text/html"
                    });
                    t.navigator.msSaveBlob(x, l(c.settings))
                } else txtArea1.document.open("text/html", "replace"), txtArea1.document.write(c.format(m, c.ctx)), txtArea1.document.close(), txtArea1.focus(), sa = txtArea1.document.execCommand("SaveAs", !0, l(c.settings));
            else s = c.uri + c.base64(c.format(m, c.ctx)), r = a.createElement("a"), r.download = l(c.settings), r.href = s, a.body.appendChild(r), r.click(), a.body.removeChild(r);
            return !0
        }
    }, e.fn[i] = function(t) {
        var a = this;
        return a.each(function() {
            e.data(a, "plugin_" + i) || e.data(a, "plugin_" + i, new o(this, t))
        }), a
    }
}(jQuery, window, document);